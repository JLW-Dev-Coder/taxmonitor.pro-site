{
  "clickupProjection": [
    {
      "list": "Orders",
      "status": "10 Compliance Records"
    }
  ],
  "contract": {
    "authority": ["R2 Canonical"],
    "governs": "Form — Staff — Compliance Records",
    "path": "app/contracts/staff/compliance-records.contract.json",
    "source": "Tax Monitor Pro",
    "title": "Tax Monitor Pro — Form Contract — Staff — Compliance Records",
    "validation": {
      "enumStrict": true,
      "normalizeCheckboxToBoolean": true,
      "rejectUnknownValues": true
    },
    "version": 1
  },
  "delivery": {
    "endpoint": "/forms/staff/compliance-records",
    "method": "POST",
    "receiptKeyPattern": "receipts/{source}/{eventId}.json",
    "receiptSource": "form"
  },
  "effects": {
    "dedupeKey": "payload.eventId",
    "writes": ["orders"],
    "writeOrder": ["receiptAppend", "canonicalUpsert", "clickupProjection"],
    "receiptAppend": {
      "to": "receipts/{source}/{eventId}.json"
    },
    "canonicalUpsert": {
      "target": "orders/{orderId}.json",
      "patch": {
        "reportReady": true,
        "stepBooleans": {
          "complianceSubmitted": true
        }
      }
    },
    "ordersPatch": {
      "reportReady": true,
      "stepBooleans": {
        "complianceSubmitted": true
      }
    }
  },
  "payload": {
    "additionalProperties": false,
    "properties": {
      "Account_ID": {
        "type": ["string", "null"],
        "minLength": 1
      },
      "Call_Reference_Number": {
        "type": ["string", "null"],
        "maxLength": 200
      },
      "Compliance_Activity_Type": {
        "type": "string",
        "enum": [
          "Filing compliance review",
          "IRS account verification",
          "IRS notice review",
          "IRS transcript request",
          "Status confirmation"
        ]
      },
      "eventId": {
        "type": "string",
        "minLength": 1
      },
      "orderId": {
        "type": "string",
        "minLength": 1
      },
      "sessionToken": {
        "type": "string",
        "minLength": 1
      }
    },
    "required": [
      "Compliance_Activity_Type",
      "eventId",
      "orderId",
      "sessionToken"
    ],
    "type": "object"
  },
  "schema": {
    "name": "tm_staff_compliance_form_contract",
    "version": 1
  }
}